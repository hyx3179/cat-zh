dojo.declare("com.nuclearunicorn.game.Calendar",null,{game:null,seasons:[{name:"spring",title:$I("calendar.season.spring"),shortTitle:$I("calendar.season.spring.short"),modifiers:{catnip:1.5}},{name:"summer",title:$I("calendar.season.summer"),shortTitle:$I("calendar.season.summer.short"),modifiers:{catnip:1}},{name:"autumn",title:$I("calendar.season.autumn"),shortTitle:$I("calendar.season.autumn.short"),modifiers:{catnip:1}},{name:"winter",title:$I("calendar.season.winter"),shortTitle:$I("calendar.season.winter.short"),
modifiers:{catnip:.25}}],cycleYearColors:["#A00000","#DBA901","#14CD61","#01A9DB","#9A2EFE"],cycles:[{name:"charon",title:$I("space.planet.charon.label"),glyph:"&#9049;",uglyph:"\u2359",effects:{"moonOutpost-unobtainiumPerTickSpace":.9,"entangler-gflopsConsumption":2},festivalEffects:{catnip:1.5,wood:1.5,minerals:1.5}},{name:"umbra",title:$I("space.planet.umbra.label"),glyph:"&#9062;",uglyph:"\u2366",effects:{"hydrofracturer-oilPerTickAutoprodSpace":.75,"planetCracker-uraniumPerTickSpace":.9,"hrHarvester-energyProduction":1.5},
festivalEffects:{coal:1.5,iron:1.5,titanium:1.5,gold:1.5}},{name:"yarn",title:$I("space.planet.yarn.label"),glyph:"&#9063;",uglyph:"\u2367",effects:{"hydroponics-catnipRatio":2,"researchVessel-starchartPerTickBaseSpace":.5},festivalEffects:{culture:2}},{name:"helios",title:$I("space.planet.helios.label"),glyph:"&#8978;",uglyph:"\u2312",effects:{"cryostation-woodMax":.9,"cryostation-mineralsMax":.9,"cryostation-coalMax":.9,"cryostation-ironMax":.9,"cryostation-titaniumMax":.9,"cryostation-oilMax":.9,
"cryostation-uraniumMax":.9,"cryostation-unobtainiumMax":.9,"sunlifter-energyProduction":1.5},festivalEffects:{faith:2,unicorns:1.25}},{name:"cath",title:$I("space.planet.cath.label"),glyph:"&#9022;",uglyph:"\u233e",effects:{"spaceStation-scienceRatio":1.5,"sattelite-observatoryRatio":2,"sattelite-starchartPerTickBaseSpace":2,"spaceBeacon-starchartPerTickBaseSpace":.1,"spaceElevator-prodTransferBonus":2},festivalEffects:{manpower:2}},{name:"redmoon",title:$I("space.planet.moon.label"),glyph:"&#9052;",
uglyph:"\u235c",effects:{"moonOutpost-unobtainiumPerTickSpace":1.2,"entangler-gflopsConsumption":.5},festivalEffects:{unobtainium:2}},{name:"dune",title:$I("space.planet.dune.label"),glyph:"&#9067;",uglyph:"\u236b",effects:{"hydrofracturer-oilPerTickAutoprodSpace":1.5,"planetCracker-uraniumPerTickSpace":1.1,"hrHarvester-energyProduction":.75},festivalEffects:{uranium:2}},{name:"piscine",title:$I("space.planet.piscine.label"),glyph:"&#9096;",uglyph:"\u2388",effects:{"hydroponics-catnipRatio":.5,"researchVessel-starchartPerTickBaseSpace":1.5},
festivalEffects:{science:2}},{name:"terminus",title:$I("space.planet.terminus.label"),glyph:"&#9053;",uglyph:"\u235d",effects:{"cryostation-woodMax":1.2,"cryostation-mineralsMax":1.2,"cryostation-coalMax":1.2,"cryostation-ironMax":1.2,"cryostation-titaniumMax":1.2,"cryostation-oilMax":1.2,"cryostation-uraniumMax":1.2,"cryostation-unobtainiumMax":1.2,"sunlifter-energyProduction":.5},festivalEffects:{oil:2}},{name:"kairo",title:$I("space.planet.kairo.label"),glyph:"&#8483;",uglyph:"\u2123",effects:{"spaceStation-scienceRatio":.75,
"sattelite-observatoryRatio":.75,"sattelite-starchartPerTickBaseSpace":.75,"spaceBeacon-starchartPerTickBaseSpace":5,"spaceElevator-prodTransferBonus":.5},festivalEffects:{starchart:5}}],ticksPerDay:10,daysPerSeason:100,seasonsPerYear:null,yearsPerCycle:null,cyclesPerEra:null,darkFutureBeginning:4E4,season:0,cycle:0,cycleYear:0,day:0,year:0,eventChance:0,weather:null,festivalDays:0,futureSeasonTemporalParadox:-1,cryptoPrice:1E3,observeBtn:null,observeRemainingTime:0,observeClear:function(){this.observeBtn&&
dojo.destroy(this.observeBtn);this.observeBtn=null;this.observeRemainingTime=0;this.game.ui.observeClear()},observeHandler:function(){this.observeClear();this.game.stats.getStat("eventsObserved").val++;var c=25*(this.game.workshop.get("celestialMechanics").researched?this.game.ironWill?1.6:1.2:1)*(1+this.game.getEffect("scienceRatio")),b=this.game.workshop.get("seti").researched;if(this.game.science.get("astronomy").researched){var a=1+.25*this.game.getEffect("timeRatio");a*=this.game.prestige.getPerk("chronomancy").researched?
1.1:1;a*=.0025+this.game.getEffect("starEventChance");this.game.prestige.getPerk("astromancy").researched&&(a*=2);a=1>=a?1:Math.floor(a)+(this.game.rand(1E4)<1E4*(a-Math.floor(a))?1:0);c=this.game.resPool.addResEvent("science",c*a);0<c&&!b&&this.game.msg($I("calendar.msg.science",[this.game.getDisplayValueExt(c)]),"","astronomicalEvent",!0);b||this.game.msg($I("calendar.msg.starchart",[a]),"","astronomicalEvent");this.game.resPool.addResEvent("starchart",a)}else c=this.game.resPool.addResEvent("science",
c),0<c&&!b&&this.game.msg($I("calendar.msg.science",[this.game.getDisplayValueExt(c)]),"","astronomicalEvent",!0)},observeTimeout:function(){this.observeClear();var c=this.game.getEffect("starAutoSuccessChance");this.game.prestige.getPerk("astromancy").researched&&(c*=2);var b=this.game.rand(100);(this.game.ironWill&&25>=b||b<=100*c)&&this.observeHandler()},constructor:function(c,b){this.game=c;this.displayElement=b;this.seasonsPerYear=this.seasons.length;this.yearsPerCycle=this.cycleYearColors.length;
this.cyclesPerEra=this.cycles.length},render:function(){},update:function(){},cycleYearColor:function(){return this.cycleYearColors[this.cycleYear]},cycleEffectsBasics:function(c,b){if(this.game.prestige.getPerk("numerology").researched){var a=this.cycles[this.cycle].effects,e;for(e in c){var d=b+"-"+e;"undefined"!==typeof a[d]&&(c[e]*=a[d])}}return c},cycleEffectsFestival:function(c){if(this.game.prestige.getPerk("numeromancy").researched&&this.game.calendar.festivalDays){var b=this.cycles[this.cycle].festivalEffects,
a;for(a in c){var e=a;"undefined"!==typeof b[e]&&(c[a]*=b[e],c[a]*=1+this.game.getEffect("festivalRatio"))}}return c},trueYear:function(){return(this.day/this.daysPerSeason+this.season)/this.seasonsPerYear+this.year-this.game.time.flux},darkFutureYears:function(c){c=this.darkFutureBeginning+(c?this.game.getEffect("timeImpedance"):0);return this.year-c},tick:function(){0<this.observeRemainingTime&&(this.observeRemainingTime--,0==this.observeRemainingTime&&this.observeTimeout());var c=Math.floor(this.day),
b=this.game.timeAccelerationRatio();this.day+=(1+b)/this.ticksPerDay;this._roundToCentiday();var a=this.ticksPerDay*this.daysPerSeason*this.seasonsPerYear;this.game.time.flux=0>this.day?this.game.time.flux-1/(1+b)/a:this.game.time.flux+b/a;if(Math.floor(this.day)!=c){b=c=!1;this.day>=this.daysPerSeason&&(this.day-=this.daysPerSeason,this._roundToCentiday(),this.season+=1,c=!0,this.season>=this.seasonsPerYear&&(this.season=0,this.year+=this.game.challenges.isActive("1000Years")&&500<=this.year?0:1,
b=!0));this.onNewDay();if(c&&(this.onNewSeason(),b))this.onNewYear(!0);this.update()}},_roundToCentiday:function(){this.day=Math.round(100*this.day)/100},onNewDay:function(){this.festivalDays&&(this.festivalDays--,!this.game.getEffect("festivalLuxuryConsumptionRatio")||this.game.resPool.get("furs").value&&this.game.resPool.get("ivory").value&&this.game.resPool.get("spice").value||(this.game.msg($I("village.festival.msg.deficitEnd"),"important"),this.festivalDays=0));var c=1+.25*this.game.getEffect("timeRatio"),
b=(this.game.prestige.getPerk("chronomancy").researched?1.1:1)*c;c*=this.game.prestige.getPerk("unicornmancy").researched?1.1:1;0>this.day?this.game.resPool.addResEvent("void",this.game.resPool.getVoidQuantity()):this.game.resPool.addResPerTick("relic",this.game.getEffect("relicPerDay"));this.game.religion.pactsManager.necrocornConsumptionDays(1);this.game.religion.getZU("blackPyramid").updateEffects(this.game.religion.getZU("blackPyramid"),this.game);this.game.religion.getPact("payDebt").onNewDay(this.game);
this.game.religion.pactsManager.necrocornDeficit>=this.game.religion.pactsManager.fractureNecrocornDeficit&&this.game.religion.pactsManager.necrocornDeficitPunishment();if(0<this.game.bld.get("library").on){var a=(.0025+this.game.getEffect("starEventChance"))*b;this.game.prestige.getPerk("astromancy").researched&&(a*=2);this.game.rand(1E4)<1E4*a&&(0<this.observeRemainingTime&&this.observeTimeout(),this.game.challenges.isActive("blackSky")?30>this.game.bld.get("observatory").val&&this.game.msg($I("challendge.blackSky.event"),
"","astronomicalEvent"):this.game.workshop.get("seti").researched?this.observeHandler():(this.observeClear(),this.game.msg($I("calendar.msg.event"),"","astronomicalEvent"),a=dojo.byId("observeButton"),this.observeBtn=dojo.create("input",{id:"observeBtn",type:"button",value:$I("navbar.observe")},a),dojo.connect(this.observeBtn,"onclick",this,this.observeHandler),this.observeRemainingTime=this.game.ironWill?600:300,this.game.ui.observeCallback(this.observeHandler)))}a=0;this.game.ironWill&&(a=40);b*=
10;if(this.game.rand(1E4)<b+a&&this.game.science.get("mining").researched){a=50+25*this.game.getEffect("mineralsRatio");b=this.game.getEffect("academyMeteorBonus");this.game.ironWill&&(a+=.1*a);a=this.game.resPool.addResEvent("minerals",a*(1+b));var e=0;this.game.workshop.get("celestialMechanics").researched&&(e=15*(1+this.game.getEffect("scienceRatio")),e=this.game.resPool.addResEvent("science",e*(1+b)));if(0<a||0<e)b=$I("calendar.msg.meteor"),0<a&&(b+=", +"+this.game.getDisplayValueExt(a)+" "+$I("resources.minerals.title")),
0<e&&(b+=", +"+this.game.getDisplayValueExt(e)+" "+$I("resources.science.title")),this.game.msg(b+"!",null,"meteor")}this.game.challenges.isActive("pacifism")&&(a=this.game.science.get("animal"),b=this.game.resPool.get("unicorns"),this.game.rand(1E5)<=17*c&&2>b.value&&a.researched&&(this.game.resPool.addResEvent("unicorns",1),this.game.msg($I("calendar.msg.unicorn"))));a=this.game.resPool.get("zebras");this.game.ironWill?(e=this.game.science.get("archery"),b=this.game.resPool.get("unicorns"),this.game.rand(1E5)<=
17*c&&2>b.value&&e.researched&&(this.game.resPool.addResEvent("unicorns",1),this.game.msg($I("calendar.msg.unicorn"))),!a.value&&e.researched?(this.game.resPool.addResEvent("zebras",1),this.game.msg($I("calendar.msg.zebra.hunter"))):0<a.value&&a.value<=this.game.karmaZebras&&0<this.game.karmaZebras&&(b=this.game.workshop.getZebraUpgrade("darkBrew").researched&&this.festivalDays?2+this.game.getEffect("festivalArrivalRatio"):1,this.game.rand(1E5)<=500*b&&(this.game.resPool.addResEvent("zebras",1),this.game.msg($I("calendar.msg.zebra.hunter.new")),
this.game.ui.render()))):(b=0,this.game.prestige.getPerk("zebraDiplomacy").researched&&(b=Math.floor(.1*(this.game.karmaZebras+1))),this.game.prestige.getPerk("zebraCovenant").researched&&(b=Math.floor(.5*(this.game.karmaZebras+1))),a.value>b&&(this.game.msg(1<a.value?$I("calendar.msg.zebra.hunter.departed.pl"):$I("calendar.msg.zebra.hunter.departed")),a.value=b,this.game.ui.render()));b=this.game.getEffect("riftChance");this.game.rand(1E4)<1E4*b*c&&(b=500*(1+.1*this.game.getEffect("unicornsRatioReligion")),
this.game.msg($I("calendar.msg.rift",[this.game.getDisplayValueExt(b)]),"notice","unicornRift"),this.game.resPool.addResEvent("unicorns",b));b=this.game.getEffect("alicornChance");b*=1+this.game.getLimitedDR(this.game.getEffect("alicornPerTickRatio"),1.2);this.game.rand(1E5)<1E5*b&&(this.game.msg($I("calendar.msg.alicorn"),"important","alicornRift"),this.game.resPool.addResEvent("alicorn",1),this.game.upgrade({zigguratUpgrades:["skyPalace","unicornUtopia","sunspire"]}));b=0+this.game.getEffect("ivoryMeteorChance");
this.game.rand(1E4)<1E4*b*c&&(c=250+this.game.rand(1500)*(1+this.game.getEffect("ivoryMeteorRatio")),this.game.msg($I("calendar.msg.ivoryMeteor",[this.game.getDisplayValueExt(c)]),"notice","ivoryMeteor"),this.game.resPool.addResEvent("ivory",c));this.game.diplomacy.onNewDay();this.adjustCryptoPrice();this.game.upgrade({policies:["authocracy"]})},fastForward:function(c){var b=1+.25*this.game.getEffect("timeRatio"),a=(this.game.prestige.getPerk("chronomancy").researched?1.1:1)*b,e=(this.game.prestige.getPerk("unicornmancy").researched?
1.1:1)*b,d=0;b=0;if(0<this.game.bld.get("library").on){d=(.0025+this.game.getEffect("starEventChance"))*a;this.game.prestige.getPerk("astromancy").researched&&(d*=2);var f=this.game.getEffect("starAutoSuccessChance");this.game.prestige.getPerk("astromancy").researched&&(f*=2);this.game.workshop.get("seti").researched&&(f=1);f=Math.min(f,1);(d=Math.round(c*d*f))&&!this.game.challenges.isActive("blackSky")&&this.game.resPool.addResEvent("starchart",d);f=this.game.workshop.get("celestialMechanics").researched?
this.game.ironWill?1.6:1.2:1;f=25*d*f*(1+this.game.getEffect("scienceRatio"));this.game.resPool.addResEvent("science",f);b+=d}d=0;this.game.ironWill&&(d=40);a*=10;this.game.science.get("mining").researched&&(d=Math.round(c*(a+d)/1E4),a=50+25*this.game.getEffect("mineralsRatio"),this.game.ironWill&&(a+=.1*a),this.game.resPool.addResEvent("minerals",d*a),this.game.workshop.get("celestialMechanics").researched&&(f=15*(1+this.game.getEffect("scienceRatio")),this.game.resPool.addResEvent("science",d*f)),
b+=d);a=this.game.resPool.get("zebras");this.game.ironWill&&(d=this.game.science.get("archery"),2>this.game.resPool.get("unicorns").value&&d.researched&&(d=Math.round(17*c*e/1E5),this.game.resPool.addResEvent("unicorns",d),b+=d),0<a.value&&a.value<=this.game.karmaZebras&&0<this.game.karmaZebras&&(d=Math.round(500*c/1E5),this.game.resPool.addResEvent("zebras",d),b+=d));a=this.game.getEffect("riftChance");d=Math.round(c*a*e);this.game.resPool.addResEvent("unicorns",500*d);b+=d;a=this.game.getEffect("alicornChance");
a*=1+this.game.getLimitedDR(this.game.getEffect("alicornPerTickRatio"),1.2);d=Math.round(c*a);1<=d&&(this.game.resPool.addResEvent("alicorn",d),this.game.upgrade({zigguratUpgrades:["skyPalace","unicornUtopia","sunspire"]}));b+=d;a=0+this.game.getEffect("ivoryMeteorChance");if(d=Math.round(c*a*e))e=250+this.game.rand(1500)*(1+this.game.getEffect("ivoryMeteorRatio")),this.game.resPool.addResEvent("ivory",e*d);b+=d;e=Math.floor(c/(this.daysPerSeason*this.seasonsPerYear));a=this.game.resPool;a.energyProd>=
a.energyCons&&a.addResEvent("antimatter",this.game.getEffect("antimatterProduction")*e);d=this.game.space.getBuilding("spaceBeacon");d.action(d,this.game);this.game.updateCaches();this.game.resPool.addResPerTick("relic",this.game.getEffect("relicPerDay")*c);this.game.religion.pactsManager.necrocornConsumptionDays(c);d=10+this.game.getEffect("temporalParadoxDay");f=d+100*Math.max(1,100/this.game.bld.get("chronosphere").on);d/=f;this.game.resPool.addResEvent("void",Math.floor(this.game.resPool.getVoidQuantityStatistically()*
c*d));this.game.science.get("antimatter").researched&&(c=this.game.math.loopOrGaussianApproximation(c-1,!1,1.249927083463528E-6,1.4427062504448777E-10,this.game.math.log1p(-2.5E-5),this.game.math.log1p(2.5E-5),function(){var g=Math.random();return.3>g?this.game.math.log1p((g-.3)/12E3):.6>g?0:this.game.math.log1p((g-.6)/16E3)}),this.game.calendar.cryptoPrice*=Math.exp(c),this.adjustCryptoPrice());this.game.challenges.isActive("1000Years")&&500<this.year+e&&(e=Math.max(500-this.year,0));c=Math.floor((this.year+
e)/1E3)-Math.floor(this.year/1E3);0<c&&(a.addResEvent("paragon",c),this.game.stats.getStat("totalParagon").val+=c);this.game.religion.pactsManager.pactsMilleniumKarmaKittens(c);this.year+=e;this.game.stats.getStat("totalYears").val+=e;return b},onNewSeason:function(){this.eventChance=0;if(3<this.year){var c=175,b=175,a=this.game.getLimitedDR(1E3*this.game.getEffect("coldChance"),825);c+=a;b-=a;0>b&&(b=0);"winter"==this.getCurSeason().name&&this.game.challenges.getChallenge("winterIsComing").researched&&
!this.game.challenges.isActive("winterIsComing")&&(c=0);a=this.game.rand(1E3);this.weather=a<b?"warm":a<b+c?"cold":null}else this.weather=null;2==this.season&&this.game.workshop.get("advancedAutomation").researched&&(this.game.bld.get("steamworks").jammed=!1);this.game.upgrade({buildings:["pasture"]});c=this.game.bld.get("chronosphere").on;if(0<c)if(0<this.futureSeasonTemporalParadox)this.futureSeasonTemporalParadox--;else{this.day=-10-this.game.getEffect("temporalParadoxDay");b=0;for(a=!0;a;)c>this.game.rand(100)?
a=!1:b++;this.futureSeasonTemporalParadox=b}},getMilleniaChanged:function(c,b){return Math.max(0,(1E3*Math.floor(b/1E3)-1E3*Math.floor(c/1E3))/1E3)},calculateMilleniumProduction:function(c){this.game.resPool.addResEvent("paragon",c);this.game.stats.getStat("totalParagon").val+=c;this.game.religion.pactsManager.pactsMilleniumKarmaKittens(c)},onNewYears:function(c,b,a){var e=this.game.stats.getStat("totalYears");e.val+=b;e.val<this.year&&(e.val=this.year);0<=this.darkFutureYears()&&this.game.unlock({chronoforge:["temporalImpedance"]});
this.game.bld.get("steamworks").jammed&&(this.game.bld.get("steamworks").jammed=!1);a&&this.calculateMilleniumProduction(this.getMilleniaChanged(this.year-b,this.year));a=this.game.religion.getZU("blackPyramid").getEffectiveValue(this.game);e=this.game.religion.getZU("marker").getEffectiveValue(this.game);0<a&&this.game.rand(1E3)<35*a*b*(1+.1*e)&&this.game.diplomacy.unlockElders();this.game.diplomacy.get("leviathans").unlocked&&(this.game.challenges.getChallenge("blackSky").unlocked=!0);this.cycleYear+=
b;this.cycleYear>=this.yearsPerCycle&&(a=Math.floor(this.cycleYear/this.yearsPerCycle),this.cycleYear%=this.yearsPerCycle,this.cycle=a+this.cycle>=this.cyclesPerEra?(a+this.cycle)%this.cyclesPerEra:this.cycle+a);this.game.upgrade({spaceBuilding:this.game.space.spaceBuildingsMap});a=this.game.resPool;a.energyProd>=a.energyCons&&a.addResEvent("antimatter",this.game.getEffect("antimatterProduction")*b);a.addResEvent("temporalFlux",this.game.getEffect("temporalFluxProduction")*b);e=this.game.bld.get("aiCore").effects.aiLevel;
if(14<e&&1!=this.game.science.getPolicy("transkittenism").researched&&(e-=14,!this.game.getEffect("shatterTCGain")))for(var d in this.game.resPool.resources){var f=this.game.resPool.resources[d];f.aiCanDestroy&&a.addResEvent(f.name,-f.value*(1-Math.pow(1-.01*e,b)))}this.game.upgrade({policies:["authocracy"]});c&&this.game.ui.render()},onNewYear:function(c){var b=this.game.stats.getStat("totalYears");b.val++;b.val<this.year&&(b.val=this.year);0<=this.darkFutureYears()&&this.game.unlock({chronoforge:["temporalImpedance"]});
this.game.bld.get("steamworks").jammed&&(this.game.bld.get("steamworks").jammed=!1);0===this.year%1E3&&(this.game.resPool.addResEvent("paragon",1),this.game.stats.getStat("totalParagon").val++,this.game.resPool.get("kittens"),this.game.religion.pactsManager.pactsMilleniumKarmaKittens(1));b=this.game.religion.getZU("blackPyramid").getEffectiveValue(this.game);var a=this.game.religion.getZU("marker").getEffectiveValue(this.game);0<b&&this.game.rand(1E3)<35*b*(1+.1*a)&&this.game.diplomacy.unlockElders();
this.game.diplomacy.get("leviathans").unlocked&&(this.game.challenges.getChallenge("blackSky").unlocked=!0);++this.cycleYear>=this.yearsPerCycle&&(this.cycleYear=0,++this.cycle>=this.cyclesPerEra&&(this.cycle=0));this.game.upgrade({spaceBuilding:this.game.space.spaceBuildingsMap});b=this.game.resPool;b.energyProd>=b.energyCons&&b.addResEvent("antimatter",this.game.getEffect("antimatterProduction"));b.addResEvent("temporalFlux",this.game.getEffect("temporalFluxProduction"));a=this.game.bld.get("aiCore").effects.aiLevel;
if(14<a&&1!=this.game.science.getPolicy("transkittenism").researched){a-=14;this.game.msg($I("ai.apocalypse.msg",[a]),"alert","ai");for(var e in this.game.resPool.resources){var d=this.game.resPool.resources[e];d.aiCanDestroy&&b.addResEvent(d.name,.01*-d.value*a)}}this.game.upgrade({policies:["authocracy"]});c&&this.game.ui.render()},adjustCryptoPrice:function(){this.game.science.get("antimatter").researched&&(this.cryptoPrice+=this.cryptoPrice*(1-this.game.rand(10)%3)*Math.random()/4E4,1100<this.cryptoPrice&&
this.correctCryptoPrice())},correctCryptoPrice:function(){this.cryptoPrice*=.7+.1*Math.random();this.game.msg($I("trade.correct.bcoin"),"important")},getWeatherMod:function(c){var b=this.getCurSeason().modifiers[c.name]?this.getCurSeason().modifiers[c.name]:1;if("catnip"!=c.name)return b;if(this.game.science.getPolicy("communism").researched&&"winter"==this.getCurSeason().name&&"cold"==this.weather)return 0;"warm"==this.weather?b+=.15:"cold"==this.weather&&(b+=-.15);this.game.challenges.getChallenge("winterIsComing").on&&
"cold"==this.weather&&(b*=1+this.game.getLimitedDR(this.game.getEffect("coldHarshness"),1));"spring"==this.getCurSeason().name&&(b*=1+this.game.getLimitedDR(this.game.getEffect("springCatnipRatio"),2));return b},getCurSeason:function(){return this.game.challenges.isActive("winterIsComing")?this.seasons[3]:this.seasons[this.season]},getCurSeasonTitle:function(){var c=this.game.challenges.isActive("winterIsComing")?this.getWinterIsComingNumeral():"";return this.getCurSeason().title+c},getCurSeasonTitleShorten:function(){var c=
this.game.challenges.isActive("winterIsComing")?this.getWinterIsComingNumeral():"";return this.getCurSeason().shortTitle+c},getWinterIsComingNumeral:function(){switch(this.season){case 0:return" I";case 1:return" II";case 2:return" III";case 3:return" IV"}return""},resetState:function(){this.season=this.day=this.year=0;this.weather=null;this.cycleYear=this.cycle=this.festivalDays=0;this.futureSeasonTemporalParadox=-1;this.observeClear()},save:function(c){c.calendar={year:this.year,day:this.day,season:this.season,
weather:this.weather,festivalDays:this.festivalDays,cycle:this.cycle,cycleYear:this.cycleYear,futureSeasonTemporalParadox:this.futureSeasonTemporalParadox,cryptoPrice:this.cryptoPrice}},load:function(c){c.calendar&&(this.year=c.calendar.year||0,this.day=c.calendar.day||0,this.season=c.calendar.season||0,this.weather=c.calendar.weather||null,this.festivalDays=c.calendar.festivalDays||0,this.cycle=c.calendar.cycle||0,this.cycleYear=c.calendar.cycleYear||0,this.futureSeasonTemporalParadox=c.calendar.futureSeasonTemporalParadox||
-1,this.cryptoPrice=c.calendar.cryptoPrice||1E3)}});dojo.declare("com.nuclearunicorn.game.calendar.Event",null,{});
